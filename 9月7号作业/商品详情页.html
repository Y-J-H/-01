<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/index.css">
  <link rel="stylesheet" href="css/proDetail.css">
</head>
<body>
<header class="headList">
  <div class="headWrap">
    <div class="headLeft">
      <ul>
        <li><a href="#">菜单1</a></li>
        <li class="line">|</li>
        <li><a href="#">菜单1</a></li>
        <li class="line">|</li>
        <li><a href="#">菜单1</a></li>
        <li class="line">|</li>
        <li><a href="#">菜单1</a></li>
        <li class="line">|</li>
        <li><a href="#">菜单1</a></li>
        <li class="line">|</li>
        <li><a href="#">菜单1</a></li>
        <li class="line">|</li>
        <li><a href="#">菜单1</a></li>
        <li class="line">|</li>
        <li><a href="#">菜单1</a></li>
        <li class="line">|</li>
        <li><a href="#">菜单1</a></li>
        <li class="line">|</li>
        <li><a href="#">菜单1菜单1</a></li>
      </ul>
    </div>
    <div class="headRight">
      <ul>
        <li id="login" class="login"><a href="登录.html">登录</a></li>
        <li class="line">|</li>
        <li id="register" class="register"><a href="注册页面.html">注册</a></li>
        <li class="line">|</li>
        <li id="buy_car" class="buy_car"><a href="#">购物车</a></li>
      </ul>
    </div>
  </div>
</header>
<nav id="main-nav" class="main-nav clearfix">
  <ul></ul>
</nav>
<div id="productDetail" class="productDetail">
  <!--<div class="DetailWrap clearfix">-->
    <!--<div class="productDetailLeft">-->
      <!--<img src="images/10元包邮pic.jpg" alt="">-->
    <!--</div>-->
    <!--<div class="productDetailRight">-->
      <!--<h3>轻型款鸵鸟枕【宝蓝灰】</h3>-->
      <!--<p class="des">她让我们舒适，让我们温暖，也在一直关照着我们。陪我们穿过人潮人海、经...</p>-->
      <!--<p id="price" class="price">&yen;<i>299.00</i></p>-->
      <!--<div class="buy">-->
        <!--<span class="buyNow">立即购买</span>-->
        <!--<span class="addCar">加入购物车</span>-->
      <!--</div>-->
    <!--</div>-->
  <!--</div>-->
</div>
</body>
<script type="text/javascript" src="js/myajax.js"></script>
<script>
  var oNavUl = document.querySelector('#main-nav').querySelector('ul');
  myajax.get('http://h6.duchengjiu.top/shop/api_cat.php', {}, function(error, responseText) {
    var data = JSON.parse(responseText);
    for (var k in data) {
      if (k === 'data') {
        for (var i = 0; i < data[k].length; i++) {
          // oUl.innerHTML += '<li>' + data[k][i]['cat_name'] + '</li>';
          oNavUl.innerHTML +=
              `<li><a href="商品列表页.html?cat_id=${data[k][i]['cat_id']}"> ${data[k][i]['cat_name']} </a></li>`;
        }
      }
    }
  });
  console.log(matchQueryString('goods_id'));

  var productDetail = document.querySelector('#productDetail');
  myajax.get(' http://h6.duchengjiu.top/shop/api_goods.php', {goods_id: matchQueryString('goods_id')},
      function(error, jsonData) {
        var json = JSON.parse(jsonData);
        var data = json.data[0];
//      console.log(json);
        productDetail.innerHTML += ` <div class="DetailWrap clearfix">
                                        <div class="productDetailLeft">
                                          <img src="${data['goods_thumb']}" alt="">
                                        </div>
                                        <div class="productDetailRight">
                                          <h3>${data['goods_name']}</h3>
                                          <p class="des">${data['goods_desc']}</p>
                                          <p id="price" class="price">&yen;<i>${data['price']}</i></p>
                                          <div class="buy">
                                            <span class="buyNow">立即购买</span>
                                            <span class="addCar">加入购物车</span>
                                          </div>
                                        </div>
                                    </div>`;

        var pro = document.querySelector('.addCar');
        pro.onclick = function() {
          location.href='购物车页面.html';
          myajax.post('http://h6.duchengjiu.top/shop/api_cart.php?token='+localStorage.getItem('token'),
              {
                goods_id : data['goods_id'],
              },function(error,jsonData){
                console.log(JSON.parse(jsonData));
              });
        }
      });
</script>
</html>