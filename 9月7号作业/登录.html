<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/login.css">
</head>
<body>
  <header class="logo">
    <img src="images/mistore_logo.png" alt="">
  </header>
  <div id="loginContain" class="loginContain">
    <div class="wrap">
      <div id="loginForm" class="loginForm">
        <h3>账号登录</h3>
        <input id="username" type="text" name="username" placeholder="用户名">
        <input id="password" type="password" name="password"placeholder="密码">
        <div class="errorMessage">用户名不存在</div>
        <input id="sub" class="sub" type="button" value="提交">
      </div>
    </div>
  </div>
  <footer class="foot">

  </footer>
  <script type="text/javascript" src="js/myajax.js"></script>
  <script>
      var oSub = document.querySelector('#sub');
      var oUsername = document.querySelector('#username');
      var oPassword = document.querySelector('#password');
      var oError = document.querySelector('.errorMessage');

      oSub.addEventListener('click',function() {
        myajax.post('http://h6.duchengjiu.top/shop/api_user.php',{
          status : 'login',
          username : oUsername.value,
          password : oPassword.value
        },function(error,jsonData){
          var json = JSON.parse(jsonData);
          console.log(json);
          oError.innerText = json.message;
          if(json.code === 1000 || json.code === 1001 || json.code === 2002 ) {
            oError.style.display = "block";
            oError.classList.add('error');
          }else if(json.code === 0){
            localStorage.setItem('token',json['data']['token']);
            location.href = "index.html";
//            location.href = "index.html?data="+JSON.stringify(json);    这样可以把数据传回主页
          }
        })
      },false);
  </script>
</body>
</html>