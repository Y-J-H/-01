<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/index.css">
</head>
<body>
<header class="headList">
  <div class="headWrap">
    <div class="headLeft">
      <ul>
        <li><a href="#">菜单1</a></li><li class="line">|</li>
        <li><a href="#">菜单1</a></li><li class="line">|</li>
        <li><a href="#">菜单1</a></li><li class="line">|</li>
        <li><a href="#">菜单1</a></li><li class="line">|</li>
        <li><a href="#">菜单1</a></li><li class="line">|</li>
        <li><a href="#">菜单1</a></li><li class="line">|</li>
        <li><a href="#">菜单1</a></li><li class="line">|</li>
        <li><a href="#">菜单1</a></li><li class="line">|</li>
        <li><a href="#">菜单1</a></li><li class="line">|</li>
        <li><a href="#">菜单1菜单1</a></li>
      </ul>
    </div>
    <div class="headRight">
      <ul>
        <li id="login" class="login"><a href="登录.html">登录</a></li>
        <li class="line">|</li>
        <li id="register" class="register"> <a href="注册页面.html">注册</a></li>
        <li class="line">|</li>
        <li id="buy_car" class="buy_car"><a href="#">购物车</a></li>
      </ul>
    </div>
  </div>
</header>
<nav id="main-nav" class="main-nav clearfix">
  <ul></ul>
</nav>
<div id="hotPro" class="hotPro">
  <!--<ul class="hotProList clearfix">-->
    <!--&lt;!&ndash;<li>&ndash;&gt;-->
      <!--&lt;!&ndash;<a href="#">&ndash;&gt;-->
        <!--&lt;!&ndash;<div class="hotProListImg">&ndash;&gt;-->
          <!--&lt;!&ndash;<img src="images/10元包邮pic.jpg"/>&ndash;&gt;-->
        <!--&lt;!&ndash;</div>&ndash;&gt;-->
        <!--&lt;!&ndash;<div class="hotProListInfor">&ndash;&gt;-->
          <!--&lt;!&ndash;<h3 class="hotProName" title="仅重600g便携蓝牙音箱 丹麦设计 专业级音质 防滑防水 长续航">仅重600g便携蓝牙音箱 丹麦设计 专业级音质 防滑防水 长续航</h3>&ndash;&gt;-->
          <!--&lt;!&ndash;<p class="des">真正的便捷式蓝牙扬声器，既可畅想音乐又可接听来电，重量只有600g</p>&ndash;&gt;-->
          <!--&lt;!&ndash;<span class="price"><i>&yen;</i>1898.00</span>&ndash;&gt;-->
        <!--&lt;!&ndash;</div>&ndash;&gt;-->
      <!--&lt;!&ndash;</a>&ndash;&gt;-->
    <!--&lt;!&ndash;</li>&ndash;&gt;-->
  <!--</ul>-->
</div>
<script type="text/javascript" src="js/myajax.js"></script>
<script>
  var oNavUl = document.querySelector('#main-nav').querySelector('ul');
  var hotPro = document.querySelector('#hotPro');
  myajax.get('http://h6.duchengjiu.top/shop/api_goods.php', { pagesize : 100}, function(error, jsonData) {
    var json = JSON.parse(jsonData)['data'];
    for (var i = 0; i < json.length; i++) {
      if (json[i]['is_hot'] === '1') {
        if(i % 12 === 0){
          oUl = document.createElement('ul');
          oUl.classList.add('hotProList');
          oUl.classList.add('clearfix');
          oUl.style.display = 'none';
          hotPro.appendChild(oUl);
        }
        bindDom(json[i]);
      }
    }
    controlPage();
    showPage();
  });

  myajax.get('http://h6.duchengjiu.top/shop/api_cat.php', {}, function(error, responseText) {
    var data = JSON.parse(responseText);
    for (var k in data) {
      if (k === 'data') {
        for (var i = 0; i < data[k].length; i++) {
          // oUl.innerHTML += '<li>' + data[k][i]['cat_name'] + '</li>';
          oNavUl.innerHTML +=
              `<li><a href="商品列表页.html?cat_id=${data[k][i]['cat_id']}"> ${data[k][i]['cat_name']} </a></li>`;
        }
      }
    }
  });

  function bindDom(obj) {
    oUl.innerHTML +=
        '<li>\n' +
        '      <a href="商品详情页.html?goods_id='+obj['goods_id']+'">\n' +
        '        <div class="hotProListImg">\n' +
        '          <img src=' + obj['goods_thumb'] + '>\n' +
        '        </div>\n' +
        '        <div class="hotProListInfor">\n' +
        '          <h3 class="hotProName" title=' + obj['goods_name'] + '>' + obj['goods_name'] + '</h3>\n' +
        '          <p class="des">' + obj['goods_desc'] + '</p>\n' +
        '          <span class="price"><i>&yen;</i>' + obj['price'] + '</span>\n' +
        '        </div>\n' +
        '      </a>\n' +
        '    </li>';
  }

console.log(localStorage.getItem('token'));























  var querySearch = location.search;
  function getData(querySearch){
//    console.log(querySearch);
//    console.log(matchQueryString('data'));
    var userJson = JSON.parse(matchQueryString('data'));
    console.log(userJson);
  }
  getData(querySearch);


  // 控制总共多少页
  function controlPage() {
    var allUl = document.querySelector('#hotPro').querySelectorAll('ul');
    var ol = document.createElement('ol');
    for(var i = 0; i < allUl.length; i++){
        ol.innerHTML += "<li>"+ i +"</li>"
    }
    hotPro.appendChild(ol);
  }

  function showPage() {
    var allUl = document.querySelector('#hotPro').querySelectorAll('ul');
    var oLi = document.querySelector('ol').querySelectorAll('li');

    allUl[0].style.display = "block";

    for(var i = 0; i < oLi.length; i++){
        oLi[i].onclick = (function(n) {
          return function() {

            for(var j = 0; j < allUl.length; j++){
                allUl[j].style.display = "none";
            }

            allUl[n].style.display = "block";
          }
        })(i);
    }
  }
</script>
</body>
</html>